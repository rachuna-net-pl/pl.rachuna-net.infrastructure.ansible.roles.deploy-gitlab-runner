---
- name: "ğŸ’¾ Install gitlab-runner"
  block:
    - name: "ğŸ’¾ Install Gitlab Runner on Alpine"
      ansible.builtin.apk:
        name:
          - curl
          - bash
          - ca-certificates
          - git
          - gitlab-runner
        state: present
        update_cache: true
  rescue:
    - name: "âŒ Print error if GitLab Runner installation fails"
      ansible.builtin.debug:
        msg: "GitLab Runner installation failed! Check logs."


- name: "ğŸ’¾ Install and Configure docker"
  block:
    - name: "ğŸ’¾ Install Docker on Alpine"
      ansible.builtin.apk:
        name:
          - docker
          - docker-cli
        state: present
        update_cache: true

    - name: "ğŸš¦ Enable and start Docker service"
      ansible.builtin.command: rc-update add docker default
      changed_when: false

    - name: "ğŸš¦ Start Docker now"
      ansible.builtin.service:
        name: docker
        state: started

  when: input_install_docker
  rescue:
    - name: "âŒ Print error if Docker installation fails"
      ansible.builtin.debug:
        msg: "Docker installation failed! Check logs."
